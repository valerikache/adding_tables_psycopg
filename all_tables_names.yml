create_table:
  curricula_vitae: "abilympics_status TEXT, abilympics_participation INT, add_certificates_orig TEXT, add_certificates TEXT, add_certificates_modified TEXT, additional_skills_orig TEXT, additional_skills TEXT, birthday INT, birthday_mistake INT, business_trips INT, busy_type TEXT, country TEXT, date_creation DATE, date_inactivation DATE, date_last_updated DATE, date_modify_inner_info DATE, date_publish DATE, date_time_publish TIMESTAMP, drive_licences TEXT, driver_licence_A INT, driver_licence_B INT, driver_licence_C INT, driver_licence_D INT, driver_licence_E INT, education_type TEXT, experience INT, experience_mistake INT, gender TEXT, id_candidate TEXT, id_cv TEXT, id_user_inner_info TEXT, inactive INT, industry_code TEXT, inner_info_deleted BOOLEAN, inner_info_fullness_rate INT, inner_info_status TEXT, inner_info_visibility INT, locality TEXT, md5_hash TEXT PRIMARY KEY, nark_certificate INT, nark_inspection_status INT, other_info_orig TEXT, other_info TEXT, other_info_modified TEXT, position_name_orig TEXT, position_name TEXT, profession_code TEXT, region_code TEXT, relocation INT, retraining_capability INT, salary INT, schedule_type TEXT, schedule_type_1 INT, schedule_type_2 INT, schedule_type_3 INT, schedule_type_4 INT, schedule_type_5 INT, schedule_type_6 INT, skills_orig TEXT, skills TEXT, time_publish TIME, worldskills_international_name TEXT, worldskills_is_international BOOLEAN, worldskills_russian_name TEXT, worldskills_skill_abbreviation TEXT, worldskills_type INT, worldskills_inspection_status TEXT, worldskills_inspection_status_code TEXT"
  workexp:  "achievements_orig TEXT, achievements TEXT, achievements_modified TEXT, company_name TEXT, date_from DATE, date_last_updated DATE, date_to DATE, date_mistake INT, demands_orig TEXT, demands TEXT, id_cv TEXT, job_title_orig TEXT, job_title TEXT, md5_hash TEXT PRIMARY KEY, type TEXT"
  edu: "date_last_updated DATE, faculty_orig TEXT, faculty TEXT, graduate_year INT, id_cv TEXT, legal_name_orig TEXT, legal_name TEXT, md5_hash TEXT PRIMARY KEY, qualification_orig TEXT, qualification TEXT, speciality_orig TEXT, speciality TEXT, grad_year_mistake INT, type TEXT"
  addedu: "course_name_orig TEXT, course_name TEXT, date_last_updated DATE, description TEXT, id_cv TEXT, graduate_year INT, grad_year_mistake INT, legal_name_orig TEXT, legal_name TEXT, md5_hash TEXT PRIMARY KEY, type TEXT"
  invitations: "activity_flag_candidate INT, activity_flag_manager INT, id_candidate TEXT, date_creation DATE, date_modify DATE, id_hiring_organization TEXT, id_cv TEXT, id_reply TEXT, id_vacancy TEXT, id_invitation TEXT, is_new INT, region_code TEXT, response_type TEXT, date_creation_mistake INT, date_modify_mistake INT, date_last_updated DATE, md5_hash TEXT"
  professions: "profession_code TEXT, profession_name TEXT, active BOOLEAN, category TEXT, date_creation DATE, date_creation_mistake INT, date_modify DATE, date_modify_mistake INT, deleted BOOLEAN, etks TEXT"
  stat_companies: "id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY, region_code TEXT, region_name TEXT, company_count INT, micro_company INT, small_company INT, midle_company INT, big_company INT, large_company INT"
  stat_citizens: "id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY, region_code TEXT, region_name TEXT, cvs_count INT, medium_salary FLOAT, region_code_mistake INT"
  industries: "active BOOLEAN, date_creation DATE, date_creation_mistake INT, date_modify DATE, date_modify_mistake INT, deleted BOOLEAN, industry_code TEXT, industry_name TEXT"
  organizations: "id_organization TEXT, address TEXT, address_code TEXT, business_size TEXT, code_parent_company TEXT, company_structure_hidden BOOLEAN,  date_change_inner_info DATE, date_change_inner_info_mistake INT, date_time_change_inner_info TIMESTAMP, time_change_inner_info TIME, date_creation DATE, date_creation_mistake INT, date_moderation_inner_info DATE, date_moderation_inner_info_mistake INT, date_modify_inner_info DATE, date_modify_inner_info_mistake INT, date_last_updated DATE, description TEXT, description_orig TEXT, hr_agency BOOLEAN, first_rate_company INT, inn TEXT,  inner_info_deleted BOOLEAN, inner_info_id_author TEXT, inner_info_is_moderated BOOLEAN, inner_info_manager_ids TEXT, inner_info_registration_status TEXT, inner_info_status TEXT, inner_info_disable_import_info BOOLEAN, inner_info_disable_import_vacancy BOOLEAN, inner_info_disable_join_company BOOLEAN, inner_info_disable_join_manager BOOLEAN, inner_info_code_external_system TEXT, inner_info_id_user TEXT, inner_info_id_small_icon TEXT, inner_info_moderation_comment TEXT, inner_info_moderation_comment_orig TEXT,  inner_info_state_program TEXT, inner_info_id_logo TEXT, inner_info_external_id TEXT, kpp TEXT, legal_form_code TEXT, legal_form_name TEXT, legal_name TEXT, md5_hash TEXT, name TEXT, ogrn TEXT, region_code TEXT, site TEXT, source TEXT, state_program TEXT"
  regions: "region_code TEXT, region_name TEXT, accomodation_accessibility FLOAT, attraction_region FLOAT, economic_growth FLOAT, kindergarten_accessibility FLOAT, medium_salary_difference FLOAT, price_level FLOAT, unemployment_level FLOAT"
  responses: "activity_flag_candidate INT, activity_flag_manager INT, date_creation DATE, date_creation_mistake INT, date_last_updated DATE, date_modify DATE, date_modify_mistake INT, id_candidate TEXT, id_cv TEXT, id_hiring_organization TEXT, is_new INT, id_reply TEXT, id_response TEXT, id_vacancy TEXT, md5_hash TEXT, region_code TEXT, response_type TEXT"
  vacancies: "accommodation_capability INT, accommodation_housing TEXT, additional_info TEXT, additional_info_orig TEXT, base_salary TEXT, base_salary_max FLOAT, base_salary_min FLOAT, career_perspective TEXT, career_perspective_orig TEXT, caring_workers INT, date_change_inner_info DATE, date_change_inner_info_mistake INT, date_creation DATE, date_creation_mistake INT, date_inactivation DATE, date_last_updated DATE, date_modify_inner_info DATE, date_modify_inner_info_mistake INT, date_posted DATE, date_posted_mistake INT, date_time_change_inner_info TIMESTAMP, date_time_posted TIMESTAMP, disabled INT, dms INT, drive_licences TEXT, driver_licence_A INT, driver_licence_B INT, driver_licence_C INT, driver_licence_D INT, driver_licence_E INT, education_academic_degree TEXT, education_requirements_education_type TEXT, education_requirements_speciality TEXT, education_requirements_speciality_orig TEXT, employment_type TEXT, experience_requirements INT, federal_district TEXT, id_hiring_organization TEXT, identifier TEXT, inactive INT, incentive_compensation_transport_compensation TEXT, industry TEXT, inner_info_contact_source TEXT, inner_info_deleted BOOLEAN, inner_info_metro_ids TEXT, inner_info_source_type TEXT, inner_info_status TEXT, inner_info_visibility INT, is_uzbekistan_recruitment BOOLEAN, job_benefits TEXT, job_benefits_other_benefits TEXT, job_benefits_other_benefits_orig TEXT, job_location_additional_address_info TEXT, job_location_address TEXT, job_location_geo_latitude TEXT, job_location_geo_longitude TEXT, large_families INT, md5_hash TEXT PRIMARY KEY, metro_station TEXT, minor_workers INT, need_medcard INT, okso_code TEXT, organization TEXT, payment_meals INT, payment_sports_activities INT, premium_size FLOAT, premium_type TEXT, profession TEXT, region TEXT, released_persons INT, requirements_id_priority_category TEXT, requirements_qualifications TEXT, requirements_qualifications_orig TEXT, requirements_required_certificates TEXT, requirements_required_certificates_orig TEXT, responsibilities TEXT, responsibilities_orig TEXT, retraining_capability INT, retraining_condition TEXT, retraining_condition_orig TEXT, retraining_grant INT, retraining_grant_value FLOAT, single_parent INT, social_protecteds_social_protected TEXT, source TEXT, time_change_inner_info TIME, time_posted TIME, title TEXT, vac_url TEXT, vouchers_health_institutions INT, work_hours TEXT, work_places INT, workers_with_disabled_children INT"
  for_matching_cv: "id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY, identifier TEXT, text_w2v TEXT, salary INT, experience_salary INT, btrips_salary_cv INT, btrips_relocation_cv INT, retraining_capability INT"
  for_matching_vac: "id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY, identifier TEXT, text_w2v TEXT, salary INT, experience_salary INT, accommodation_salary_vac INT, retraining_capability INT"
  
better_col_names:
  curricula_vitae: {'add_certificates': 'add_certificates_orig', 'additional_skills': 'additional_skills_orig', 'candidate_id': 'id_candidate', 'country_country_name': 'country', 'creation_date': 'date_creation', 'competitions_abilympics_inspection_status': 'abilympics_status', 'competitions_abilympics_participation': 'abilympics_participation', 'drive_licence_list_drive_licences': 'drive_licences', 'industries': 'industry_code', 'inner_info_date_modify': 'date_modify_inner_info', 'inner_info_id_user': 'id_user_inner_info', 'other_info': 'other_info_orig', 'position_name': 'position_name_orig', 'publish_date': 'date_publish', 'regions': 'region_code', 'qualification_nark_certificate': 'nark_certificate', 'qualification_nark_inspection_status': 'nark_inspection_status', 'schedule_types_list_schedule_type': 'schedule_type', 'skills': 'skills_orig', 'worldskills_competence_international_name': 'worldskills_international_name', 'worldskills_competence_is_international': 'worldskills_is_international', 'worldskills_competence_russian_name': 'worldskills_russian_name', 'worldskills_competence_skill_abbreviation': 'worldskills_skill_abbreviation', 'worldskills_competence_type': 'worldskills_type'}

  workexp: {'achievements': 'achievements_orig', 'demands': 'demands_orig', 'id_owner': 'id_cv', 'job_title': 'job_title_orig'}
  
  edu: {'id_owner': 'id_cv', 'specialty': 'speciality_orig', 'faculty': 'faculty_orig', 'legal_name': 'legal_name_orig', 'qualification': 'qualification_orig'}
  
  addedu: {'id_owner': 'id_cv', 'legal_name': 'legal_name_orig', 'course_name': 'course_name_orig'}
  
  invitations: {'creation_date': 'date_creation', 'candidate_id': 'id_candidate', 'hiring_organization_identifier': 'id_hiring_organization', 'identifier': 'id_invitation'}
  
  stat_citizens: {'code': 'region_code', 'name': 'region_name'}
  
  stat_companies: {'code': 'region_code', 'name': 'region_name'}
  
  industries: {'code': 'industry_code', 'name': 'industry_name', 'creation_date': 'date_creation'}
  
  organizations: {'creation_date': 'date_creation', 'inner_info_date_modify': 'date_modify_inner_info', 'inner_info_moderation_time': 'date_moderation_inner_info', 'inner_info_change_time': 'date_change_inner_info', 'hr-agency': 'hr_agency', 'description': 'description_orig', 'inner_info_moderation_comment': 'inner_info_moderation_comment_orig'}
  
  professions: {'name': 'profession_name', 'creation_date': 'date_creation'}
  
  regions: {'code': 'region_code', 'name': 'region_name'}
  
  responses: {'candidate_id': 'id_candidate', 'creation_date': 'date_creation', 'hiring_organization_identifier': 'id_hiring_organization', 'identifier': 'id_response'}
  
  vacancies: {'creation_date': 'date_creation', 'date_posted': 'date_posted', 'base_salary_salary': 'base_salary', 'base_salary_salary_min': 'base_salary_min', 'base_salary_salary_max': 'base_salary_max', 'employment_type': 'employment_type', 'incentive_compensation_retraining_grant': 'retraining_grant', 'incentive_compensation_job_benefits_other_benefits': 'job_benefits_other_benefits_orig', 'requirements_education_requirements_education_type': 'education_requirements_education_type', 'requirements_experience_requirements': 'experience_requirements', 'additional_info': 'additional_info_orig', 'inner_info_date_modify': 'date_modify_inner_info', 'isUzbekistanRecruitment': 'is_uzbekistan_recruitment', 'incentive_compensation_premium_premium_type': 'premium_type', 'incentive_compensation_premium_premium_size': 'premium_size', 'inner_info_change_time': 'date_change_inner_info', 'required_drive_license': 'drive_licences', 'incentive_compensation_accommodation_capability': 'accommodation_capability', 'incentive_compensation_job_benefits_benefits': 'job_benefits', 'incentive_compensation_retraining_capability': 'retraining_capability', 'requirements_education_requirements_speciality': 'education_requirements_speciality_orig', 'career_perspective': 'career_perspective_orig', 'incentive_compensation_accommodation_housing': 'accommodation_housing', 'metro_stations_metro_station': 'metro_station', 'incentive_compensation_retraining_condition': 'retraining_condition_orig', 'incentive_compensation_retraining_grant_value': 'retraining_grant_value', 'requirements_education_requirements_academic_degree' : 'education_academic_degree', 'hiring_organization_identifier' : 'id_hiring_organization', 'responsibilities': 'responsibilities_orig', 'requirements_qualifications': 'requirements_qualifications_orig', 'requirements_required_certificates': 'requirements_required_certificates_orig'}
  
get_df_join:
  curricula_vitae: "SELECT project_trudvsem.curricula_vitae.id_cv AS identifier, LOWER(industry_code) AS industry_code, position_name, STRING_AGG(demands, ',') AS demands, business_trips, relocation, retraining_capability, salary, experience, project_trudvsem.professions.profession_name FROM project_trudvsem.curricula_vitae LEFT JOIN project_trudvsem.workexp ON project_trudvsem.curricula_vitae.id_cv = project_trudvsem.workexp.id_cv LEFT JOIN project_trudvsem.professions ON project_trudvsem.curricula_vitae.profession_code = project_trudvsem.professions.profession_code  where project_trudvsem.curricula_vitae.inactive = 0 GROUP BY project_trudvsem.curricula_vitae.id_cv, project_trudvsem.professions.profession_name, industry_code, position_name, business_trips, relocation, retraining_capability, salary, experience"
  vacancies: "SELECT project_trudvsem.vacancies.identifier, LOWER(industry) AS industry_code, title AS position_name, responsibilities AS demands, accommodation_capability, retraining_capability, base_salary_min AS salary, experience_requirements AS experience, profession_name FROM project_trudvsem.vacancies LEFT JOIN project_trudvsem.professions ON project_trudvsem.vacancies.profession = project_trudvsem.professions.profession_code where project_trudvsem.vacancies.inactive = 0 GROUP BY project_trudvsem.vacancies.identifier, project_trudvsem.professions.profession_name, project_trudvsem.vacancies.industry, project_trudvsem.vacancies.title, project_trudvsem.vacancies.responsibilities, project_trudvsem.vacancies.accommodation_capability, project_trudvsem.vacancies.retraining_capability, salary, experience"

delete_duplicates:
  invitations: "id_invitation"
  responses: "id_response"
  organizations: "id_organization"
    
md5_hash:
  curricula_vitae: ['addCertificates', 'additionalSkills', 'businessTrips', 'busyType', 'candidateId', 'country_country_name', 'creationDate', 'driveLicenceList_driveLicences', 'experience', 'id_cv', 'industries', 'innerInfo_deleted', 'innerInfo_fullnessRate', 'innerInfo_idUser', 'innerInfo_status', 'innerInfo_visibility', 'locality', 'otherInfo', 'positionName', 'profession_code', 'regions', 'relocation', 'retrainingCapability', 'salary', 'scheduleTypesList_scheduleType', 'skills', 'worldskills_competence_internationalName', 'worldskills_competence_isInternational', 'worldskills_competence_russianName', 'worldskills_competence_skillAbbreviation', 'worldskills_competence_type']
  vacancies: ['region', 'organization', 'industry', 'identifier', 'hiringOrganization_identifier', 'baseSalary_salary', 'baseSalary_salaryMin', 'baseSalary_salaryMax', 'title', 'employmentType', 'workHours', 'responsibilities', 'incentiveCompensation_retraining_grant', 'incentiveCompensation_jobBenefits_otherBenefits', 'requirements_educationRequirements_educationType', 'requirements_experienceRequirements', 'requirements_qualifications', 'jobLocation_address', 'jobLocation_additionalAddressInfo', 'jobLocation_geo_latitude', 'jobLocation_geo_longitude', 'source', 'workPlaces', 'additionalInfo', 'innerInfo_sourceType', 'innerInfo_status', 'innerInfo_visibility', 'innerInfo_contactSource', 'innerInfo_deleted', 'vac_url', 'profession', 'socialProtecteds_socialProtected', 'incentiveCompensation_transportCompensation', 'requiredDriveLicense', 'incentiveCompensation_accommodation_capability', 'requirements_educationRequirements_speciality', 'oksoCode', 'incentiveCompensation_premium_premiumType', 'incentiveCompensation_premium_premiumSize', 'incentiveCompensation_retraining_capability', 'metroStations_metroStation', 'needMedcard', 'innerInfo_metro_ids', 'requirements_requiredCertificates', 'incentiveCompensation_accommodation_housing', 'careerPerspective', 'incentiveCompensation_jobBenefits_benefits', 'incentiveCompensation_retraining_condition', 'incentiveCompensation_retraining_grantValue', 'requirements_educationRequirements_academicDegree']
  
variable_normalization:
  curricula_vitae: ['business_trips', 'relocation', 'retraining_capability', 'salary', 'experience']
  vacancies: ['accommodation_capability', 'retraining_capability', 'salary', 'experience']
  maximum_experience: 10
  maximum_salary: 100000
  
subset_list:
 curricula_vitae: ['position_name', 'demands', 'industry_code', 'salary', 'experience', 'region_code']
 vacancies: ['title', 'responsibilities', 'industry', 'base_salary_min', 'experience_requirements', 'region']
 
working_directory: "workdir"
  
